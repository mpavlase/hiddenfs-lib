<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>hiddenfs-lib: Zdrojový soubor hiddenfs-lib.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generováno programem Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Hledat');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Hlavní&nbsp;stránka</span></a></li>
      <li><a href="pages.html"><span>Ostatní&nbsp;stránky</span></a></li>
      <li><a href="namespaces.html"><span>Prostory&nbsp;jmen</span></a></li>
      <li><a href="annotated.html"><span>Třídy</span></a></li>
      <li class="current"><a href="files.html"><span>Soubory</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Hledat" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Seznam&nbsp;souborů</span></a></li>
      <li><a href="globals.html"><span>Symboly&nbsp;v&nbsp;souborech</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>hiddenfs-lib.h</h1>  </div>
</div>
<div class="contents">
<a href="hiddenfs-lib_8h.html">Zobrazit dokumentaci tohoto souboru.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a><a class="code" href="hiddenfs-lib_8h.html#a0919197af2e154da2c05727b6d87cbda">00008</a> <span class="preprocessor">#define FUSE_USE_VERSION 26</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#include &lt;fuse.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="common_8h.html">common.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="content_table_8h.html">contentTable.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="hash_table_8h.html">hashTable.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="struct_table_8h.html">structTable.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="super_block_8h.html">superBlock.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="types_8h.html">types.h</a>&quot;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="hiddenfs-lib_8h.html#ac56f2a768e0ea162dabf32a0af98c7d3">00020</a> <span class="preprocessor">#define GET_INSTANCE (hiddenFs*) fuse_get_context()-&gt;private_data</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="keyword">namespace </span>HiddenFS {
<a name="l00023"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html">00023</a>     <span class="keyword">class </span><a class="code" href="class_hidden_f_s_1_1hidden_fs.html">hiddenFs</a> {
<a name="l00024"></a>00024     <span class="keyword">public</span>:
<a name="l00029"></a>00029         <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a562e4bf59bed7975c4270241b55d474d" title="Umožňuje nastavit vlastní implementaci šifrování.">hiddenFs</a>(<a class="code" href="class_hidden_f_s_1_1_i_encryption.html">IEncryption</a>* instance);
<a name="l00030"></a>00030         <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2723c9c0caea639c65e13d8c65fa9276">~hiddenFs</a>();
<a name="l00031"></a>00031 
<a name="l00033"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a193a5de294f5650cd022e950333a6c99">00033</a>         <span class="keyword">typedef</span> <a class="code" href="class_hidden_f_s_1_1_c_r_c.html#a90646ce091006e022149e26ba25e9dcf">CRC::CRC_t</a> checksum_t;
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a818f6df26ee9eac0b50c6e7aee7a7555">00035</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a818f6df26ee9eac0b50c6e7aee7a7555">BLOCK_USABLE_LENGTH</a> = <a class="code" href="types_8h.html#ae0595a802b5defaa9dbe70a24924307b" title="maximální délka obecně pro zápis dat do úložiště (implicitně 4kB)">BLOCK_MAX_LENGTH</a> - <span class="keyword">sizeof</span>(checksum_t) - <span class="keyword">sizeof</span>(<a class="code" href="namespace_hidden_f_s.html#a83303481f25d1501d8996176b5bee37b" title="datový typ identifikačního byte pro rozlišení superbloku a běžného bloku (unsigned char)...">id_byte_t</a>);
<a name="l00036"></a>00036 
<a name="l00038"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#accc2e098a18dff20fd24f8217db5bcb0">00038</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#accc2e098a18dff20fd24f8217db5bcb0" title="maximální využití každého fyzického souboru (více virtuálních souborů v rámci jednoho fyzického)...">ALLOCATOR_SPEED</a> = 1 &lt;&lt; 0;
<a name="l00039"></a>00039 
<a name="l00041"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a66b76f378c8196f9273a64195fcee70f">00041</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a66b76f378c8196f9273a64195fcee70f" title="zamezit míchání více bloků virtuálních souborů v rámci jednoho skutečného">ALLOCATOR_SECURITY</a> = 1 &lt;&lt; 1;
<a name="l00042"></a>00042 
<a name="l00044"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1a281d07d41e606b17f2567a21ced00f">00044</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1a281d07d41e606b17f2567a21ced00f" title="uložení jednoho bloku se provede několikanásobně do různých fyzických souborů">ALLOCATOR_REDUNDANCY</a> = 1 &lt;&lt; 7;
<a name="l00045"></a>00045 
<a name="l00052"></a>00052         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aa6662126078838277abefa5bb600295b" title="Nastaví preferovanou strategii pro alokování nových bloků.">allocatorSetStrategy</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> strategy, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> redundancy);
<a name="l00053"></a>00053 
<a name="l00060"></a>00060         <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9b3b3c1999778ce38662ca46af2c4ef0" title="Hlavní výkonná metoda (wrapper nad fuse_main).">run</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]);
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad288420ac7dcf4d9cd238e071e231bea">00062</a>         <span class="keyword">static</span> std::string <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad288420ac7dcf4d9cd238e071e231bea">storagePath</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091f">00064</a>         <span class="keyword">enum</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091f">FUSE_ARGS</a> {
<a name="l00065"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091fafc90eec23c24cd0e1ceaee43b3abfa60">00065</a>             KEY_HELP,
<a name="l00066"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091fa6d862f86da5c7237c55ce0c8d07b8efa">00066</a>             KEY_CREATE,
<a name="l00067"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091fa603245fc6df26ba4d27660064ef71ae7">00067</a>             KEY_FUSE_DEBUG,
<a name="l00068"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091faeb317ebb7185dbae0db89ffa891e7810">00068</a>             KEY_REMOVE,
<a name="l00069"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a2d5e0e4ee87f363ca544cfa79680091fa9bb5cb8d8c9b80e9f885f657bdc6d0a0">00069</a>             KEY_FORCE,
<a name="l00070"></a>00070         };
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keyword">protected</span>:
<a name="l00073"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">00073</a>         <a class="code" href="class_hidden_f_s_1_1content_table.html">contentTable</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">CT</a>;
<a name="l00074"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a46d4873812d7ef21782a9f41d774a284">00074</a>         <a class="code" href="class_hidden_f_s_1_1struct_table.html">structTable</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a46d4873812d7ef21782a9f41d774a284">ST</a>;
<a name="l00075"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ab1e1dc2e8f10a4f73214617150b8d6a9">00075</a>         <a class="code" href="class_hidden_f_s_1_1hash_table.html" title="Obousměrné mapování hash a adresy ke skutečnému souboru.">hashTable</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ab1e1dc2e8f10a4f73214617150b8d6a9">HT</a>;
<a name="l00076"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8ba72ba92f10c1b5bb051749154ee5d7">00076</a>         <a class="code" href="class_hidden_f_s_1_1super_block.html">superBlock</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8ba72ba92f10c1b5bb051749154ee5d7">SB</a>;
<a name="l00077"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9e311c6ceba49305efb83180e73e83d7">00077</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9e311c6ceba49305efb83180e73e83d7">allocatorFlags</a>;
<a name="l00078"></a>00078 
<a name="l00080"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#adbdc084068d5a244bb5104d466691a7f">00080</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#adbdc084068d5a244bb5104d466691a7f" title="míra duplikace dat">allocatorRedundancy</a>;
<a name="l00081"></a>00081 
<a name="l00083"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aac890270b7b44bda301b0603730ace48">00083</a>         std::set&lt;hash_ascii_t&gt; <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aac890270b7b44bda301b0603730ace48" title="Seznam všech hash, kde se vykytují kopie superbloků.">superBlockLocations</a>;
<a name="l00084"></a>00084 
<a name="l00086"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a22a656ca0121327d73d2c676b60e9824">00086</a>         <a class="code" href="class_hidden_f_s_1_1_c_r_c.html" title="Objekt zastřešující výpočet kontrolního CRC součtu Implementace převzata z RFC 1952.">CRC</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a22a656ca0121327d73d2c676b60e9824" title="instance objektu pro výpočet kontrolního součtu">checksum</a>;
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#af62f08bb6a0a8dde258e2ca44c5182bc">00088</a>         <a class="code" href="class_hidden_f_s_1_1_i_encryption.html">IEncryption</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#af62f08bb6a0a8dde258e2ca44c5182bc">encryption</a>;
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html">00090</a>         <span class="keyword">struct </span><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html">optionsStruct</a> {
<a name="l00091"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#a44672a1b62dcb012c63199c07066282f">00091</a>             <span class="keywordtype">char</span>* <a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#a44672a1b62dcb012c63199c07066282f">storagePath</a>;
<a name="l00092"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#aaf587e3173a2d116a21c1a17c72896ec">00092</a>             <span class="keywordtype">char</span>* <a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#aaf587e3173a2d116a21c1a17c72896ec">password</a>;
<a name="l00093"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#a16ea680abca4b4acc75e25cd554b6f6b">00093</a>             <span class="keywordtype">char</span>* <a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html#a16ea680abca4b4acc75e25cd554b6f6b">mountpoint</a>;
<a name="l00094"></a>00094         };
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html">00096</a>         <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00097"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html#a05898510842b291ffe77783d781a0244">00097</a>             <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* buffer;
<a name="l00098"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html#a3210deb8262bed229fb48e80e01846a8">00098</a>             <span class="keywordtype">size_t</span> allocated;
<a name="l00099"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html#a26398e283af6bc14abee5ff4b63af68f">00099</a>             <span class="keywordtype">size_t</span> length;
<a name="l00100"></a><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html#a0bf73eff34afd4965caf17b06a292860">00100</a>             <span class="keywordtype">bool</span> enabled;
<a name="l00101"></a>00101         } <a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html">fileWriteBuff_t</a>;
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a6cb624642452c7bdfc3efa80ff6bb823">00103</a>         <a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1file_write_buff__t.html">fileWriteBuff_t</a> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a6cb624642452c7bdfc3efa80ff6bb823">fileWriteBuff</a>;
<a name="l00104"></a>00104 
<a name="l00106"></a>00106         <span class="keyword">struct </span><a class="code" href="struct_hidden_f_s_1_1hidden_fs_1_1options_struct.html">optionsStruct</a> options;
<a name="l00107"></a>00107 
<a name="l00112"></a>00112         <span class="keywordtype">void</span> <span class="keyword">static</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abde481709c7df0bc4af2856b1f42a7ff" title="Povolí/zakáže echo při čtení ze standartního vstupu.">setConsoleEcho</a>(<span class="keywordtype">bool</span> state);
<a name="l00113"></a>00113 
<a name="l00121"></a>00121         <span class="keywordtype">size_t</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a68256dce5b0751e8300729b499c4df3e" title="Vyhledá (=naalokuje) vhodný počet bloků a zapíše do nich obsah jednotlivých fragmentů.">allocatorAllocate</a>(<a class="code" href="namespace_hidden_f_s.html#a205950fe2b585160ef16e562c81c89df" title="datový typ pro číslování souborů">inode_t</a> inode, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* buffer, <span class="keywordtype">size_t</span> length);
<a name="l00122"></a>00122 
<a name="l00130"></a>00130         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ab011d69fdd32a17b75d897853a82b65a" title="Skrze parametr block vrací právě jeden volný blok na základě kritéra: Blok se musí nacházet v souboru...">allocatorFindFreeBlock_sameHash</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block, <a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> hash);
<a name="l00131"></a>00131 
<a name="l00139"></a>00139         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8b1223e9ed01037e6cb8e74ee3f06f06" title="Skrze parametr block vrací právě jeden volný blok na základě kritéra: Blok se nesmí nacházet v soubor...">allocatorFindFreeBlock_differentHash</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block, std::set&lt;hash_ascii_t&gt;&amp; excluded);
<a name="l00140"></a>00140 
<a name="l00146"></a>00146         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a31d21ad373a08bd94963f0b3b870d0d8" title="Skrze parametr block vrací právě jeden volný blok (jakýkoli volný blok).">allocatorFindFreeBlock_any</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block);
<a name="l00147"></a>00147 
<a name="l00155"></a>00155         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a31d21ad373a08bd94963f0b3b870d0d8" title="Skrze parametr block vrací právě jeden volný blok (jakýkoli volný blok).">allocatorFindFreeBlock_any</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block, <a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> prefered, std::set&lt;hash_ascii_t&gt;&amp; excluded);
<a name="l00156"></a>00156 
<a name="l00163"></a>00163         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a52f9fcec733d4b23bc17ce41fc00f2aa" title="Vyhledá volný blok v částečně obsazeném fyzickém souboru.">allocatorFindFreeBlock_partUsed</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block, std::set&lt;hash_ascii_t&gt;&amp; excluded);
<a name="l00164"></a>00164 
<a name="l00172"></a>00172         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aec2eb2a0867c6d1397f70ee0b7c0b202" title="Vyhledá volný blok v částečně obsazeném fyzickém souboru.">allocatorFindFreeBlock_partUsedPreferred</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block, std::set&lt;hash_ascii_t&gt;&amp; excluded);
<a name="l00173"></a>00173 
<a name="l00180"></a>00180         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a5bd3d21c7dbf4c7c0b97d20e3cc512b6" title="Vyhledá volný blok ve fyzickém souboru, který ještě neobsahuje žádný obsazený blok a naplní tak param...">allocatorFindFreeBlock_unused</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block);
<a name="l00181"></a>00181 
<a name="l00188"></a>00188         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ab64d4b4f5f9a9871db149e26c111cc25" title="Vyhledá (podle potřeby i naalokuje) blok, který dosud není použitý.">allocatorFindFreeBlock_unusedPreferred</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block);
<a name="l00189"></a>00189 
<a name="l00198"></a>00198         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aa6bb92231d1a034b9d40ef44d03b9507" title="Prozkoumá volné bloky v rámci hash a naplní parametr block prvním dostupným blokem.">allocatorFillFreeBlockByHash</a>(<a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> hash, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block);
<a name="l00199"></a>00199 
<a name="l00206"></a>00206         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a853fbeb024230e14be6128ca74d54719" title="Vyhledá a vrací první rezervovaný blok nehledě na to, kterému inode patří.">allocatorStealReservedBlock</a>(<a class="code" href="namespace_hidden_f_s.html#a205950fe2b585160ef16e562c81c89df" title="datový typ pro číslování souborů">inode_t</a>&amp; inode, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; block);
<a name="l00207"></a>00207 
<a name="l00213"></a>00213         <span class="keyword">virtual</span> <a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a16993a635a4c39cb4cc5e7e93c5b08cc" title="Naalokuje zdroje pro práci se skutečným souborem - otevření souboru, různé inicializace...">createContext</a>(std::string filename) = 0;
<a name="l00214"></a>00214 
<a name="l00221"></a>00221         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1c004cdeec6fc915641a7fdb37addf30" title="Pokusí se zcela odstranit zadaný blok z fyzického souboru.">removeBlock</a>(<a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> hash, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block);
<a name="l00222"></a>00222 
<a name="l00228"></a>00228         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1c004cdeec6fc915641a7fdb37addf30" title="Pokusí se zcela odstranit zadaný blok z fyzického souboru.">removeBlock</a>(<a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* context, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block) = 0;
<a name="l00229"></a>00229 
<a name="l00234"></a>00234         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a6d7307e168a3a7a32519652b1ccbcc5f" title="Uvolní naalokované prostředky pro skutečný soubor.">freeContext</a>(<a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* context) = 0;
<a name="l00235"></a>00235 
<a name="l00240"></a>00240         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a82658cce37ac321b0f527dd5b10ff40b" title="Zapíše změny do skutečného souboru.">flushContext</a>(<a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* context) = 0;
<a name="l00241"></a>00241 
<a name="l00252"></a>00252         <span class="keywordtype">size_t</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a01c8f6f9db2aa1d35bc73a4ac3399553" title="Zabezpečuje přečtení bloku obsahující fragment souboru s kontrolou kontrolního součtu a načtení ident...">readBlock</a>(<a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> hash, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>** buff, <span class="keywordtype">size_t</span> length, <a class="code" href="namespace_hidden_f_s.html#a83303481f25d1501d8996176b5bee37b" title="datový typ identifikačního byte pro rozlišení superbloku a běžného bloku (unsigned char)...">id_byte_t</a>* idByte);
<a name="l00253"></a>00253 
<a name="l00263"></a>00263         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a01c8f6f9db2aa1d35bc73a4ac3399553" title="Zabezpečuje přečtení bloku obsahující fragment souboru s kontrolou kontrolního součtu a načtení ident...">readBlock</a>(<a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* context, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* buff, <span class="keywordtype">size_t</span> length) <span class="keyword">const</span> = 0;
<a name="l00264"></a>00264 
<a name="l00273"></a>00273         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a57c853c23c8a0c072fc4733a2d735129" title="Provádí zápis bloku do skutečného souboru.">writeBlock</a>(<a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a> hash, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* buff, <span class="keywordtype">size_t</span> length, <a class="code" href="namespace_hidden_f_s.html#a83303481f25d1501d8996176b5bee37b" title="datový typ identifikačního byte pro rozlišení superbloku a běžného bloku (unsigned char)...">id_byte_t</a> idByte);
<a name="l00274"></a>00274 
<a name="l00283"></a>00283         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a57c853c23c8a0c072fc4733a2d735129" title="Provádí zápis bloku do skutečného souboru.">writeBlock</a>(<a class="code" href="struct_hidden_f_s_1_1context__t.html">context_t</a>* context, <a class="code" href="namespace_hidden_f_s.html#ad8c88a9c4f8b616ede69352fd52c3642" title="datový typ čísla bloku v rámci skutečného souboru">block_number_t</a> block, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* buff, <span class="keywordtype">size_t</span> length) = 0;
<a name="l00284"></a>00284 
<a name="l00289"></a>00289         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aa4a1bdcb990555a6cf7ff3f6365349b6" title="Naplní hash tabulku (mapování cesty skutečného souboru na jednoznačný řetězec).">storageRefreshIndex</a>(std::string filename) = 0;
<a name="l00290"></a>00290 
<a name="l00295"></a>00295         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad50eaa58544178b7a47ca007f5a74cf7" title="Prochází hash table za účelem nalezení dostatečného počtu doposud neobsazených skutečných souborů (ko...">findUnusedHash</a>();
<a name="l00296"></a>00296 
<a name="l00301"></a>00301         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a238d36c804e39a1e3a8dfb5ba01aabc1" title="Prochází hash table za účelem nalezení dostatečného počtu doposud neobsazených skutečných souborů (ko...">findPartlyUsedHash</a>();
<a name="l00302"></a>00302 
<a name="l00308"></a>00308         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a0e3dcbb7ef164ba6465a2534987f3cc4" title="Systematicky prohledává hash table za účelem naplnění některého ze seznamů.">findHashByAuxList</a>(std::set&lt;hash_ascii_t&gt;&amp; list, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> limit);
<a name="l00309"></a>00309 
<a name="l00314"></a>00314         <span class="comment">//void findPartUsedHash();</span>
<a name="l00315"></a>00315 
<a name="l00322"></a>00322         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a56f43c8d58ab876af89b618e60c8ac5e" title="Prochází hash table za účelem nalezení dostatečného počtu doposud neobsazených skutečných souborů (ko...">getContent</a>(<a class="code" href="namespace_hidden_f_s.html#a205950fe2b585160ef16e562c81c89df" title="datový typ pro číslování souborů">inode_t</a> inode, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>** buffer, <span class="keywordtype">size_t</span>* length);
<a name="l00323"></a>00323 
<a name="l00334"></a>00334         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a96771cb9afbb1f38737b802b58f4cb40" title="Provede &amp;quot;zabalení&amp;quot; bloku dat a výpočet CRC.">packData</a>(<a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* input, <span class="keywordtype">size_t</span> inputSize, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>** output, <span class="keywordtype">size_t</span>* outputSize, <a class="code" href="namespace_hidden_f_s.html#a83303481f25d1501d8996176b5bee37b" title="datový typ identifikačního byte pro rozlišení superbloku a běžného bloku (unsigned char)...">id_byte_t</a> id_byte);
<a name="l00335"></a>00335 
<a name="l00347"></a>00347         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a0d9334a681a558986a57759770e4ee79" title="Vstupní data rozdělí na CRC část a zbytek, porovná kontrolní součty (v případě nesrovnalostí vyhazuje...">unpackData</a>(<a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>* input, <span class="keywordtype">size_t</span> inputSize, <a class="code" href="namespace_hidden_f_s.html#a78ec834dee5c77304e57f21c5a1c9bb7" title="datový typ &amp;quot;jednotky&amp;quot; pro manipulaci s binárním obsahem (unsigned char)">bytestream_t</a>** output, <span class="keywordtype">size_t</span>* outputSize, <a class="code" href="namespace_hidden_f_s.html#a83303481f25d1501d8996176b5bee37b" title="datový typ identifikačního byte pro rozlišení superbloku a běžného bloku (unsigned char)...">id_byte_t</a>* id_byte);
<a name="l00348"></a>00348 
<a name="l00358"></a>00358         <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a533505e48058f0f43cd83b8d0dac7b0c" title="Provádí zápis chainListu, je vlastně trochu jiným druhem alokátoru.">chainListCompleteSave</a>(<span class="keyword">const</span> <a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a>&amp; chain, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* firstChain = NULL);
<a name="l00359"></a>00359 
<a name="l00371"></a>00371         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad113d3c73de31e61cb9c8b6260534f73" title="Načte část řetězu entit do &amp;#39;chain&amp;#39;, která se nachází v &amp;#39;location&amp;#39;.">chainListRestore</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* location, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; next, <a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a>&amp; chain, <span class="keywordtype">bool</span> onlyReadNext = <span class="keyword">false</span>);
<a name="l00372"></a>00372 
<a name="l00379"></a>00379         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9f8c828e2029de66b2550554039b5515" title="Pokusí se načíst kompletní řetěz entit.">chainListCompleteRestore</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* first, <a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a>&amp; chain);
<a name="l00380"></a>00380 
<a name="l00388"></a>00388         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a19cf6a8b03f001414d84261f2b3db19e" title="Uloží řetěz do bloku určeném parametrem location.">chainListSave</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* location, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* next, <span class="keyword">const</span> <a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a>&amp; chain);
<a name="l00389"></a>00389 
<a name="l00396"></a>00396         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a5dd9550461701b44748440bc6ae51adb" title="Vyhledá volný blok podle trochu jiných kritérií, než se používá v allocatorAllocate.">chainListAllocate</a>(<span class="keyword">const</span> <a class="code" href="namespace_hidden_f_s.html#ad697dc14547ebb74f871a269ae645121" title="datový typ pro ASCII reprezentaci binární podoby hash skutečného souboru">hash_ascii_t</a>&amp; hash, <a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>*&amp; output);
<a name="l00397"></a>00397 
<a name="l00403"></a>00403         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad4f8ea011a0cea3cd581feadebe91dad" title="Uvolní celý řetězec entit.">chainListFree</a>(<a class="code" href="struct_hidden_f_s_1_1v_block.html" title="abstrakce datového bloku obsahující právě jeden fragment">vBlock</a>* first);
<a name="l00404"></a>00404 
<a name="l00410"></a>00410         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aedf7f72b25b7c5072587c46c40b83991" title="Serializuje všechny tabulky (CT, ST), uloží všechny jejich kopie a vloží začátky řetězců do superblok...">tablesSaveToSB</a>();
<a name="l00411"></a>00411 
<a name="l00421"></a>00421         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a660a957d07bbdb947d53ddd3e9a07a7a" title="Uloží řetěz entit do několika různých kopií (počet podle konstanty TABLES_REDUNDANCY_AMOUNT) a pokud ...">tableSave</a>(<a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a>&amp; content, std::set&lt;vBlock*&gt;&amp; copies);
<a name="l00422"></a>00422 
<a name="l00429"></a>00429         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a75dfda2d69d93c09c4d836c7b4d4cb18" title="Komplexní metoda pro uložení superbloku: provádí serializaci, zápis do stávajících kopií superbloků a...">superBlockSave</a>();
<a name="l00430"></a>00430 
<a name="l00436"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a52809b9261682bfa0c59efc8868422f5">00436</a>         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a52809b9261682bfa0c59efc8868422f5" title="Provádí rekonstrukci všech tabulek (structTable i contentTable) z řetězce entit do skutečného obsahu...">tableRestoreFromSB</a>() {
<a name="l00437"></a>00437             std::set&lt;vBlock*&gt; chainCT;
<a name="l00438"></a>00438             std::set&lt;vBlock*&gt; chainST;
<a name="l00439"></a>00439             <a class="code" href="namespace_hidden_f_s.html#ae7291a022cfb068cc9f726bc3f752285" title="Abstrakce spojového seznamu, který slouží pro manipulaci s entitami (jakožto prvky obecné délky) vect...">chainList_t</a> chainList;
<a name="l00440"></a>00440             <span class="keywordtype">bool</span> success = <span class="keyword">false</span>;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442             assert(this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8ba72ba92f10c1b5bb051749154ee5d7">SB</a>-&gt;<a class="code" href="class_hidden_f_s_1_1super_block.html#a488a94e86fe5b582f0601645b2f05333">isLoaded</a>());
<a name="l00443"></a>00443 
<a name="l00444"></a>00444             this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8ba72ba92f10c1b5bb051749154ee5d7">SB</a>-&gt;<a class="code" href="class_hidden_f_s_1_1super_block.html#a97b08bfb3b43629bddbd3e1d6aff976c" title="Naplní seznam &amp;#39;chain&amp;#39; ukazateli na první bloky řetězů, &amp;#39;tableType&amp;#39; slouží jako filtr...">readKnownItems</a>(chainCT, <a class="code" href="class_hidden_f_s_1_1super_block.html#ab786266239bf9ea52cf0c9c9171815eb">superBlock::TABLE_CONTENT_TABLE</a>);
<a name="l00445"></a>00445             this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a8ba72ba92f10c1b5bb051749154ee5d7">SB</a>-&gt;<a class="code" href="class_hidden_f_s_1_1super_block.html#a97b08bfb3b43629bddbd3e1d6aff976c" title="Naplní seznam &amp;#39;chain&amp;#39; ukazateli na první bloky řetězů, &amp;#39;tableType&amp;#39; slouží jako filtr...">readKnownItems</a>(chainST, <a class="code" href="class_hidden_f_s_1_1super_block.html#a4ef8120b9abb49bf1d60b85576dee98c">superBlock::TABLE_STRUCT_TABLE</a>);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447             chainList.clear();
<a name="l00448"></a>00448             success = <span class="keyword">false</span>;
<a name="l00449"></a>00449             <span class="keywordflow">for</span>(std::set&lt;vBlock*&gt;::const_iterator i = chainCT.begin(); i != chainCT.end(); i++) {
<a name="l00450"></a>00450                 <span class="keywordflow">try</span> {
<a name="l00451"></a>00451                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9f8c828e2029de66b2550554039b5515" title="Pokusí se načíst kompletní řetěz entit.">chainListCompleteRestore</a>(*i, chainList);
<a name="l00452"></a>00452                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">CT</a>-&gt;<a class="code" href="class_hidden_f_s_1_1content_table.html#a326b24778d6f27d248891a0f437d869d" title="Provádí rekonstrukci seznamu entit a rovnou plní obsah hlavní i všech přidružených pomocných tabulek...">deserialize</a>(chainList);
<a name="l00453"></a>00453                     success = <span class="keyword">true</span>;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455                     <span class="keywordflow">break</span>;
<a name="l00456"></a>00456                 } <span class="keywordflow">catch</span>(<a class="code" href="class_hidden_f_s_1_1_exception_runtime_error.html">ExceptionRuntimeError</a>&amp;) {
<a name="l00457"></a>00457                     <span class="keywordflow">continue</span>;
<a name="l00458"></a>00458                 }
<a name="l00459"></a>00459             }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461             <span class="keywordflow">if</span>(!success) {
<a name="l00462"></a>00462                 <span class="keywordflow">throw</span> <a class="code" href="class_hidden_f_s_1_1_exception_runtime_error.html">ExceptionRuntimeError</a>(<span class="stringliteral">&quot;Rekonstrukce contentTable nebyla úspěšná.&quot;</span>);
<a name="l00463"></a>00463             }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465             chainList.clear();
<a name="l00466"></a>00466             success = <span class="keyword">false</span>;
<a name="l00467"></a>00467             <span class="keywordflow">for</span>(std::set&lt;vBlock*&gt;::const_iterator i = chainST.begin(); i != chainST.end(); i++) {
<a name="l00468"></a>00468                 <span class="keywordflow">try</span> {
<a name="l00469"></a>00469                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9f8c828e2029de66b2550554039b5515" title="Pokusí se načíst kompletní řetěz entit.">chainListCompleteRestore</a>(*i, chainList);
<a name="l00470"></a>00470                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a46d4873812d7ef21782a9f41d774a284">ST</a>-&gt;<a class="code" href="class_hidden_f_s_1_1struct_table.html#a93e242c7bf1b745019eae46aa007e31e" title="Provádí rekonstrukci seznamu entit a rovnou plní obsah hlavní i všech přidružených pomocných tabulek...">deserialize</a>(chainList);
<a name="l00471"></a>00471                     success = <span class="keyword">true</span>;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473                     <span class="keywordflow">break</span>;
<a name="l00474"></a>00474                 } <span class="keywordflow">catch</span>(<a class="code" href="class_hidden_f_s_1_1_exception_runtime_error.html">ExceptionRuntimeError</a>&amp;) {
<a name="l00475"></a>00475                     <span class="keywordflow">continue</span>;
<a name="l00476"></a>00476                 }
<a name="l00477"></a>00477             }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479             <span class="keywordflow">if</span>(!success) {
<a name="l00480"></a>00480                 <span class="keywordflow">throw</span> <a class="code" href="class_hidden_f_s_1_1_exception_runtime_error.html">ExceptionRuntimeError</a>(<span class="stringliteral">&quot;Rekonstrukce structTable nebyla úspěšná.&quot;</span>);
<a name="l00481"></a>00481             }
<a name="l00482"></a>00482         }
<a name="l00483"></a>00483 
<a name="l00489"></a><a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a0550cbdbe06e7f8a2d2948ee44b457a4">00489</a>         <span class="keywordtype">void</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a0550cbdbe06e7f8a2d2948ee44b457a4" title="Kompletně odstraní obsah souboru i včetně metadat ve structure i content table.">removeFile</a>(<a class="code" href="namespace_hidden_f_s.html#a205950fe2b585160ef16e562c81c89df" title="datový typ pro číslování souborů">inode_t</a> inode) {
<a name="l00490"></a>00490             std::set&lt;vBlock*&gt; blocks;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492             <span class="comment">// uvolnění obsahu, pokud existuje</span>
<a name="l00493"></a>00493             <span class="keywordflow">try</span> {
<a name="l00494"></a>00494                 this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">CT</a>-&gt;<a class="code" href="class_hidden_f_s_1_1content_table.html#aacdbfcee342f6d68f99fb0952f893514" title="Vyhledá veškeré bloky obsazené, či rezervované k souboru.">findAllBlocks</a>(inode, blocks);
<a name="l00495"></a>00495                 <span class="keywordflow">for</span>(std::set&lt;vBlock*&gt;::iterator i = blocks.begin(); i != blocks.end(); i++) {
<a name="l00496"></a>00496                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1c004cdeec6fc915641a7fdb37addf30" title="Pokusí se zcela odstranit zadaný blok z fyzického souboru.">removeBlock</a>((*i)-&gt;hash, (*i)-&gt;block);
<a name="l00497"></a>00497                     this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">CT</a>-&gt;<a class="code" href="class_hidden_f_s_1_1content_table.html#a7b869d2bcdbb64eb4279e2bf90451731" title="Odstraní blok z pomocného seznamu uchovávající rezerovované bloky, takže se jeví jako neobsazený...">setBlockAsUnused</a>(inode, *i);
<a name="l00498"></a>00498 
<a name="l00499"></a>00499                     <span class="keyword">delete</span> *i;
<a name="l00500"></a>00500                 }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502                 this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#abe6c091b63e2e2624c26c59471c786ac">CT</a>-&gt;<a class="code" href="class_hidden_f_s_1_1content_table.html#ad23aeda728b295e40d5f0aa7c2fcd98f" title="Odstraní inode z tabulky.">removeFile</a>(inode);
<a name="l00503"></a>00503             } <span class="keywordflow">catch</span>(<a class="code" href="class_hidden_f_s_1_1_exception_file_not_found.html">ExceptionFileNotFound</a>&amp;) {}
<a name="l00504"></a>00504 
<a name="l00505"></a>00505             <span class="comment">// uvolnění samotného záznamu</span>
<a name="l00506"></a>00506             this-&gt;<a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a46d4873812d7ef21782a9f41d774a284">ST</a>-&gt;<a class="code" href="class_hidden_f_s_1_1struct_table.html#a9fd49476f19a218d20376e914d3b3531" title="Odstraní soubor z tabulek.">removeFile</a>(inode);
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509         <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00510"></a>00510         <span class="comment">// -----------------------     FUSE     --------------------------------</span>
<a name="l00511"></a>00511         <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ac15bfca9d93d90ef1f98dc36c1e464f9">fuse_chmod</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, mode_t mode);
<a name="l00514"></a>00514         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a7e484c23c8f1302e1fded7d660e4fcae">fuse_chown</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, uid_t uid, gid_t gid);
<a name="l00515"></a>00515         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#ad2408ef5b28357970eed2de2e7849d85">fuse_create</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, mode_t mode, <span class="keyword">struct</span> fuse_file_info* file_i);
<a name="l00516"></a>00516         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#af5efcd49110ff3481b7b46f9055ece88">fuse_flush</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">struct</span> fuse_file_info* info);
<a name="l00517"></a>00517         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a97a7321bc97a4a687753e673e17e7c37" title="do stbuf nastavit délku souboru">fuse_getattr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">struct</span> stat* stbuf);
<a name="l00518"></a>00518         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a9e7e1e53ec7b3c281f5acf0621456dd1">fuse_mkdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, mode_t mode);
<a name="l00519"></a>00519         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a40e32e91c3d3d09becc47e109f67419f">fuse_open</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">struct</span> fuse_file_info* file_i);
<a name="l00520"></a>00520         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a16a6e89b463aa8237207c55e68b95816">fuse_statfs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">struct</span> statvfs* stat);
<a name="l00521"></a>00521         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a540965af165e6bb2ea342a944e145c29">fuse_read</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keywordtype">char</span>* buffer, <span class="keywordtype">size_t</span> size, off_t length, <span class="keyword">struct</span> fuse_file_info* file_i);
<a name="l00522"></a>00522         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a1b93fc7ec4af260444793a29b8ed36da">fuse_readdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keywordtype">void</span>* buffer, fuse_fill_dir_t filler, off_t offset, <span class="keyword">struct</span> fuse_file_info* file_i);
<a name="l00523"></a>00523         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a3ba0603de84d6a815ec43e00a3565b72">fuse_rename</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* from, <span class="keyword">const</span> <span class="keywordtype">char</span>* to);
<a name="l00524"></a>00524         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a5e5408179b0129fb6620b01da044dc49">fuse_rmdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path);
<a name="l00525"></a>00525         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aaf0edc60d10c84065c14b22616e1621d">fuse_truncate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, off_t length);
<a name="l00526"></a>00526         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#aa14350d82f9540c70848303174061047">fuse_unlink</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path);
<a name="l00527"></a>00527         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a4fd7cf267f6ad29039a0640831c3314b">fuse_utimens</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">const</span> <span class="keyword">struct</span> timespec tv[2]);
<a name="l00528"></a>00528         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_hidden_f_s_1_1hidden_fs.html#a6cec39744a31ada363baebae911a1f1f">fuse_write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keyword">const</span> <span class="keywordtype">char</span>* buffer, <span class="keywordtype">size_t</span> size, off_t offset, <span class="keyword">struct</span> fuse_file_info* file_i);
<a name="l00529"></a>00529         <span class="comment">// možná ještě fuse_release</span>
<a name="l00530"></a>00530     };
<a name="l00531"></a>00531 }
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>Vše</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Třídy</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Prostory jmen</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Soubory</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Funkce</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Proměnné</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Definice typů</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Výčty</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Hodnoty výčtu</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Definice maker</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generováno st 16. kvě 2012 12.39:26 pro projekt hiddenfs-lib programem&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
